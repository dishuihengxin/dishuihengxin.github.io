class SecuritySystem{constructor(){this.init()}init(){try{this.setupFormProtection(),this.setupCSRFProtection(),this.setupSecurityMonitoring(),console.log("Security system initialized")}catch(e){console.warn("Security system initialization warning:",e.message)}}setupFormProtection(){document.addEventListener("submit",e=>{const t=e.target,n=t.querySelectorAll('input[type="text"], textarea');n.forEach(e=>{this.containsDangerousContent(e.value)&&(e.value=this.sanitizeInput(e.value))})})}containsDangerousContent(e){if(!e||typeof e!="string")return!1;const t=[/<script[^>]*>/gi,/javascript:/gi,/on\w+\s*=/gi];return t.some(t=>t.test(e))}sanitizeInput(e){return!e||typeof e!="string"?"":e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}setupCSRFProtection(){const e=this.generateToken();sessionStorage.setItem("csrf_token",e),document.querySelectorAll("form").forEach(t=>{if(!t.querySelector('input[name="csrf_token"]')){const n=document.createElement("input");n.type="hidden",n.name="csrf_token",n.value=e,t.appendChild(n)}})}generateToken(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}setupSecurityMonitoring(){document.addEventListener("securitypolicyviolation",e=>{console.warn("CSP Violation:",{directive:e.violatedDirective,blockedURI:e.blockedURI})})}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>new SecuritySystem):new SecuritySystem,window.SecuritySystem=SecuritySystem