<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>故障转移 on 滴水恒心</title><link>https://www.dishuihengxin.com/tags/%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB/</link><description>Recent content in 故障转移 on 滴水恒心</description><generator>Hugo</generator><language>zh</language><lastBuildDate>Wed, 31 Dec 2025 22:00:00 +0800</lastBuildDate><atom:link href="https://www.dishuihengxin.com/tags/%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB/index.xml" rel="self" type="application/rss+xml"/><item><title>MongoDB分布式架构设计与实践：从副本集到分片集群的完整方案</title><link>https://www.dishuihengxin.com/posts/database-mongodb-distributed/</link><pubDate>Wed, 31 Dec 2025 22:00:00 +0800</pubDate><guid>https://www.dishuihengxin.com/posts/database-mongodb-distributed/</guid><description>&lt;h1 id="mongodb分布式架构设计与实践从副本集到分片集群的完整方案"&gt;MongoDB分布式架构设计与实践：从副本集到分片集群的完整方案&lt;/h1&gt;
&lt;p&gt;MongoDB作为领先的NoSQL文档数据库，在现代应用架构中广泛应用。随着数据量的增长和业务复杂度的提升，单机MongoDB已无法满足高可用、高性能的需求。本文将深入探讨MongoDB分布式架构的设计原理和实践方案，从基础的副本集到复杂的分片集群部署。&lt;/p&gt;
&lt;h2 id="mongodb分布式架构概述"&gt;MongoDB分布式架构概述&lt;/h2&gt;
&lt;h3 id="mongodb集群架构对比"&gt;MongoDB集群架构对比&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;架构模式&lt;/th&gt;
 &lt;th&gt;特点&lt;/th&gt;
 &lt;th&gt;适用场景&lt;/th&gt;
 &lt;th&gt;优点&lt;/th&gt;
 &lt;th&gt;缺点&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;单机模式&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;单个MongoDB实例&lt;/td&gt;
 &lt;td&gt;开发测试、小型应用&lt;/td&gt;
 &lt;td&gt;简单易用、性能高&lt;/td&gt;
 &lt;td&gt;无高可用、容量受限&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;副本集&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;一主多从，自动故障转移&lt;/td&gt;
 &lt;td&gt;中等规模应用&lt;/td&gt;
 &lt;td&gt;高可用、读扩展&lt;/td&gt;
 &lt;td&gt;写性能无法扩展&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;分片集群&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;水平分片，分布式存储&lt;/td&gt;
 &lt;td&gt;大规模应用&lt;/td&gt;
 &lt;td&gt;水平扩展、高性能&lt;/td&gt;
 &lt;td&gt;复杂度高、运维成本高&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;混合架构&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;分片+副本集&lt;/td&gt;
 &lt;td&gt;企业级应用&lt;/td&gt;
 &lt;td&gt;高可用+高性能&lt;/td&gt;
 &lt;td&gt;架构复杂、资源消耗大&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="mongodb分布式架构演进"&gt;MongoDB分布式架构演进&lt;/h3&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;graph TB
 subgraph &amp;#34;单机模式&amp;#34;
 A[MongoDB Server]
 A1[Application]
 A1 --&amp;gt; A
 end
 
 subgraph &amp;#34;副本集模式&amp;#34;
 B[Primary]
 B1[Secondary 1]
 B2[Secondary 2]
 B3[Application]
 B --&amp;gt; B1
 B --&amp;gt; B2
 B3 --&amp;gt; B
 B3 -.-&amp;gt; B1
 B3 -.-&amp;gt; B2
 end
 
 subgraph &amp;#34;分片集群模式&amp;#34;
 C[mongos]
 C1[Config Server RS]
 C2[Shard 1 RS]
 C3[Shard 2 RS]
 C4[Shard 3 RS]
 C5[Application]
 C --&amp;gt; C1
 C --&amp;gt; C2
 C --&amp;gt; C3
 C --&amp;gt; C4
 C5 --&amp;gt; C
 end
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="mongodb副本集配置与管理"&gt;MongoDB副本集配置与管理&lt;/h2&gt;
&lt;h3 id="副本集架构设计"&gt;副本集架构设计&lt;/h3&gt;
&lt;p&gt;MongoDB副本集是一组维护相同数据集的MongoDB服务器，提供冗余和高可用性。&lt;/p&gt;</description></item><item><title>PostgreSQL高可用架构设计与实践：从主从复制到分布式集群</title><link>https://www.dishuihengxin.com/posts/database-postgresql-ha/</link><pubDate>Wed, 31 Dec 2025 22:00:00 +0800</pubDate><guid>https://www.dishuihengxin.com/posts/database-postgresql-ha/</guid><description>&lt;h1 id="postgresql高可用架构设计与实践从主从复制到分布式集群"&gt;PostgreSQL高可用架构设计与实践：从主从复制到分布式集群&lt;/h1&gt;
&lt;p&gt;在现代企业级应用中，数据库的高可用性是系统稳定运行的基石。PostgreSQL作为功能强大的开源关系型数据库，提供了多种高可用解决方案。本文将深入探讨PostgreSQL高可用架构的设计原理和实践方案，从基础的主从复制到复杂的分布式集群部署。&lt;/p&gt;
&lt;h2 id="postgresql高可用架构概述"&gt;PostgreSQL高可用架构概述&lt;/h2&gt;
&lt;h3 id="高可用性指标定义"&gt;高可用性指标定义&lt;/h3&gt;
&lt;p&gt;在设计PostgreSQL高可用架构时，我们需要明确以下关键指标：&lt;/p&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;指标&lt;/th&gt;
 &lt;th&gt;定义&lt;/th&gt;
 &lt;th&gt;目标值&lt;/th&gt;
 &lt;th&gt;影响因素&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;可用性(Availability)&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;系统正常运行时间比例&lt;/td&gt;
 &lt;td&gt;99.9% - 99.99%&lt;/td&gt;
 &lt;td&gt;故障检测、切换时间&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;恢复时间目标(RTO)&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;系统故障后恢复服务的最大时间&lt;/td&gt;
 &lt;td&gt;&amp;lt; 5分钟&lt;/td&gt;
 &lt;td&gt;自动化程度、网络延迟&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;恢复点目标(RPO)&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;可接受的最大数据丢失量&lt;/td&gt;
 &lt;td&gt;&amp;lt; 1分钟&lt;/td&gt;
 &lt;td&gt;复制延迟、同步策略&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;故障检测时间(MTTR)&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;从故障发生到检测到的时间&lt;/td&gt;
 &lt;td&gt;&amp;lt; 30秒&lt;/td&gt;
 &lt;td&gt;监控频率、健康检查&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="高可用架构模式"&gt;高可用架构模式&lt;/h3&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;graph TB
 subgraph &amp;#34;单机模式&amp;#34;
 A[Primary Server]
 A1[定期备份]
 A --&amp;gt; A1
 end
 
 subgraph &amp;#34;主从复制模式&amp;#34;
 B[Primary Server]
 B1[Standby Server 1]
 B2[Standby Server 2]
 B --&amp;gt; B1
 B --&amp;gt; B2
 end
 
 subgraph &amp;#34;主从+负载均衡模式&amp;#34;
 C[Primary Server]
 C1[Standby Server 1]
 C2[Standby Server 2]
 C3[Load Balancer]
 C3 --&amp;gt; C
 C3 --&amp;gt; C1
 C3 --&amp;gt; C2
 C --&amp;gt; C1
 C --&amp;gt; C2
 end
 
 subgraph &amp;#34;分布式集群模式&amp;#34;
 D[Node 1]
 D1[Node 2]
 D2[Node 3]
 D3[Coordinator]
 D3 --&amp;gt; D
 D3 --&amp;gt; D1
 D3 --&amp;gt; D2
 D &amp;lt;--&amp;gt; D1
 D1 &amp;lt;--&amp;gt; D2
 D2 &amp;lt;--&amp;gt; D
 end
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="流复制streaming-replication配置"&gt;流复制(Streaming Replication)配置&lt;/h2&gt;
&lt;h3 id="主服务器配置"&gt;主服务器配置&lt;/h3&gt;
&lt;p&gt;首先配置主服务器的PostgreSQL参数：&lt;/p&gt;</description></item><item><title>Redis集群架构设计与实践：从单机到分布式的完整方案</title><link>https://www.dishuihengxin.com/posts/database-redis-cluster/</link><pubDate>Wed, 31 Dec 2025 22:00:00 +0800</pubDate><guid>https://www.dishuihengxin.com/posts/database-redis-cluster/</guid><description>&lt;h1 id="redis集群架构设计与实践从单机到分布式的完整方案"&gt;Redis集群架构设计与实践：从单机到分布式的完整方案&lt;/h1&gt;
&lt;p&gt;Redis作为高性能的内存数据库，在现代互联网架构中扮演着重要角色。随着业务规模的增长，单机Redis往往无法满足高并发、大容量的需求。本文将深入探讨Redis集群架构的设计原理和实践方案，从基础的主从复制到复杂的分布式集群部署。&lt;/p&gt;
&lt;h2 id="redis集群架构概述"&gt;Redis集群架构概述&lt;/h2&gt;
&lt;h3 id="redis集群模式对比"&gt;Redis集群模式对比&lt;/h3&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;模式&lt;/th&gt;
 &lt;th&gt;特点&lt;/th&gt;
 &lt;th&gt;适用场景&lt;/th&gt;
 &lt;th&gt;优点&lt;/th&gt;
 &lt;th&gt;缺点&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;单机模式&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;单个Redis实例&lt;/td&gt;
 &lt;td&gt;开发测试、小型应用&lt;/td&gt;
 &lt;td&gt;简单易用、性能高&lt;/td&gt;
 &lt;td&gt;无高可用、容量受限&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;主从复制&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;一主多从，读写分离&lt;/td&gt;
 &lt;td&gt;读多写少场景&lt;/td&gt;
 &lt;td&gt;读性能扩展、数据备份&lt;/td&gt;
 &lt;td&gt;主节点单点故障&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;哨兵模式&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;主从+自动故障转移&lt;/td&gt;
 &lt;td&gt;中等规模应用&lt;/td&gt;
 &lt;td&gt;自动故障转移、高可用&lt;/td&gt;
 &lt;td&gt;写性能无法扩展&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;Cluster集群&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;分布式集群&lt;/td&gt;
 &lt;td&gt;大规模应用&lt;/td&gt;
 &lt;td&gt;水平扩展、高可用&lt;/td&gt;
 &lt;td&gt;复杂度高、部分命令限制&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;&lt;strong&gt;代理模式&lt;/strong&gt;&lt;/td&gt;
 &lt;td&gt;通过代理分片&lt;/td&gt;
 &lt;td&gt;平滑迁移场景&lt;/td&gt;
 &lt;td&gt;对客户端透明&lt;/td&gt;
 &lt;td&gt;代理成为瓶颈&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="redis集群架构演进"&gt;Redis集群架构演进&lt;/h3&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;graph TB
 subgraph &amp;#34;单机模式&amp;#34;
 A[Redis Server]
 A1[Client]
 A1 --&amp;gt; A
 end
 
 subgraph &amp;#34;主从复制模式&amp;#34;
 B[Master]
 B1[Slave 1]
 B2[Slave 2]
 B3[Client]
 B --&amp;gt; B1
 B --&amp;gt; B2
 B3 --&amp;gt; B
 B3 --&amp;gt; B1
 B3 --&amp;gt; B2
 end
 
 subgraph &amp;#34;哨兵模式&amp;#34;
 C[Master]
 C1[Slave 1]
 C2[Slave 2]
 C3[Sentinel 1]
 C4[Sentinel 2]
 C5[Sentinel 3]
 C6[Client]
 C --&amp;gt; C1
 C --&amp;gt; C2
 C3 --&amp;gt; C
 C4 --&amp;gt; C
 C5 --&amp;gt; C
 C6 --&amp;gt; C3
 end
 
 subgraph &amp;#34;Cluster集群模式&amp;#34;
 D[Node 1&amp;lt;br/&amp;gt;Master]
 D1[Node 2&amp;lt;br/&amp;gt;Master]
 D2[Node 3&amp;lt;br/&amp;gt;Master]
 D3[Node 4&amp;lt;br/&amp;gt;Slave]
 D4[Node 5&amp;lt;br/&amp;gt;Slave]
 D5[Node 6&amp;lt;br/&amp;gt;Slave]
 D6[Client]
 D --&amp;gt; D3
 D1 --&amp;gt; D4
 D2 --&amp;gt; D5
 D6 --&amp;gt; D
 D6 --&amp;gt; D1
 D6 --&amp;gt; D2
 end
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="主从复制配置与优化"&gt;主从复制配置与优化&lt;/h2&gt;
&lt;h3 id="主从复制原理"&gt;主从复制原理&lt;/h3&gt;
&lt;p&gt;Redis主从复制采用异步复制机制，包含以下关键步骤：&lt;/p&gt;</description></item></channel></rss>